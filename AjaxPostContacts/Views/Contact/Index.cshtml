@{
    ViewData["Title"] = "Contact Page";
}

@model AjaxPostContacts.Models.ContactModel

<div class="row">
    <div class="col-md-8 col-lg-offset-4">
        <h2>Add User</h2>
        <br />
        <span>Name: </span> @Html.TextBoxFor(x => x.Name, new{@class = "form-control"})<br />
        <span>Date: </span> @Html.TextBoxFor(x => x.RecordDate, new{@class = "form-control", @type = "date"})<br />
        <span>Age: </span> @Html.TextBoxFor(x => x.Age, new{@class = "form-control"})<br />
        <span>City: </span> @Html.DropDownListFor(x => x.City, new SelectList(Enum.GetValues(typeof(Cities))), "Select City")<br />
        <button class="btn btn-default" onclick='SaveContact()'>Save</button> <br /> <br />

    </div>
</div>

<div class="row">
    <div class="col-md-8 col-lg-offset-3">
        <h2>New User List</h2><br />
        <table id="myTable" class="table-striped">
            <tr>
                <th>Name</th>
                <th>Date</th>
                <th>Age</th>
                <th>City</th>
            </tr>
        </table>
    </div>
</div>

<script src="https://code.jquery.com/jquery-3.6.0.min.js"
        integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4="
        crossorigin="anonymous"></script>

<script type="text/javascript">
    function SaveContact() {
        var Name = $("#Name").val();
        var RecordDate = $("#RecordDate").val();
        var Age = parseInt($("#Age").val());
        var City = $("#City").val();

        //var data = {
        //    name: Name,
        //    recorddate: RecordDate,
        //    age: Age,
        //    city: City
        //};

        //console.log(Name);
        //console.log(RecordDate);
        //console.log(Age);
        //console.log(City);

        //console.log(data);
        //console.log(JSON.stringify({ data }));

        //TODO - Post controller'a null gidiyor
        $.ajax({
            type: "POST",
            url: "/Contact/AddContact",
            //data: JSON.stringify({data}),
            //data: {name : Name, recorddate : RecordDate, age : Age, city : City},
            data: JSON.stringify({ name: Name, recorddate: RecordDate, age: Age, city: City }),
            contentType: 'application/json; charset=utf-8',
            //dataType: "json",
            success: function (result) {
                $("#myTable").append("<tr><td>" +
                    result.Name + "</td><td>" +
                    result.RecordDate + "</td><td>" +
                    result.Age + "</td><td>" +
                    result.City + "</td></tr>");
                $("#Name").val("");
                $("#RecordDate").val("");
                $("#Age").val("");
                $("#City").val("");
            },
            failure: function (result) {
                alert(result.responseText);
            }
        })
    };
</script>
